<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Hello BotScript! - @Yeu.AI</title>
  <link rel="icon" href="data:,">
</head>

<body>
  <h1 id="greeting">BotScript: Hello World!</h1>
  <p id="messages"></p>
  <script src="botscript.ai.js"></script>
  <script src="botscript.plugins.js"></script>
  <script>
    const {BotScript, Request, TYPES} = BotScriptAI;
    const bot = new BotScript();
    // bot.parse('+ * \n - Hello World!\n - Yes?\n - How are you?');
    bot.parse('> addTimeNow');
    bot.parse(`
    @ geoip https://api.ipify.org/?format=json
    #- header: value
    #- header: value (2)

    # conditional command
    + what is my ip
    * true @> geoip
    - Here is your ip: $ip

    + what time is it
    - It is $time

    `);

    /**
     * parse data from URL.
     * */
    (async function () {
      await bot.parseUrl('https://raw.githubusercontent.com/yeuai/botscript/master/examples/basic.bot');
      await sendBot('What time is it?');
      await sendBot('What is my ip?');
      await sendBot(`I'm vunb`);
    })();

    /**
     * Send bot message and wait response.
     * */
    async function sendBot(message) {
      // human ask
      appendChatbox(`Human ask: <strong>${message}</strong>`);
      const reply = await bot.handleAsync(new Request(message));
      // bot reply
      appendChatbox(`Bot reply: <em>${reply.speechResponse}</em>`);
    }

    function appendChatbox(message, id = 'messages') {
      const chatbox = document.getElementById(id);
      const elem = document.createElement("div");
      elem.innerHTML = message;
      chatbox.append(elem);
    }

    sendBot('Hello!');

  </script>
</body>

</html>
